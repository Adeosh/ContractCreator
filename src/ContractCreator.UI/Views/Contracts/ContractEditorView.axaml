<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:vm="using:ContractCreator.UI.ViewModels.Contracts"
			 xmlns:dto="using:ContractCreator.Shared.DTOs"
			 x:Class="ContractCreator.UI.Views.Contracts.ContractEditorView"
			 x:DataType="vm:ContractEditorViewModel"
			 x:Name="Root">

	<Grid>
		<Grid RowDefinitions="Auto, *">
			<Border Grid.Row="0" Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" Padding="15">
				<Grid ColumnDefinitions="Auto, *, Auto">
					<StackPanel Orientation="Horizontal" Spacing="15">
						<Button Command="{Binding CancelCommand}" Content="ðŸ ”" Classes="windowBtn"/>
						<TextBlock Text="{Binding PageTitle}" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
					</StackPanel>
					<StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="10">
						<Button Content="ÐžÑ‚Ð¼ÐµÐ½Ð°" Command="{Binding CancelCommand}"/>
						<Button Content="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ" Command="{Binding SaveCommand}" Classes="accent"/>
					</StackPanel>
				</Grid>
			</Border>

			<TabControl Grid.Row="1" Margin="10">
				<TabItem Header="ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ðµ">
					<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
						<StackPanel Margin="10,0,10,20" Spacing="25" MaxWidth="1000" HorizontalAlignment="Left">

							<Border Background="{DynamicResource CardBrush}" CornerRadius="8" Padding="15">
								<Grid ColumnDefinitions="*, 20, *, 20, *">
									<StackPanel Grid.Column="0" Spacing="5">
										<TextBlock Text="Ð’Ð¸Ð´ ÑÐ¾Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ñ *" FontWeight="Bold"/>
										<ComboBox ItemsSource="{Binding ContractTypes}"
												  SelectedItem="{Binding SelectedType}" HorizontalAlignment="Stretch"/>
									</StackPanel>

									<StackPanel Grid.Column="2" Spacing="5">
										<TextBlock Text="Ð Ð¾Ð»ÑŒ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¸ÑÑ‚Ð¸Ñ *" FontWeight="Bold"/>
										<ComboBox ItemsSource="{Binding EnterpriseRoles}"
												  SelectedItem="{Binding SelectedRole}" HorizontalAlignment="Stretch"/>
									</StackPanel>

									<StackPanel Grid.Column="4" Spacing="5">
										<TextBlock Text="Ð¢ÐµÐºÑƒÑ‰Ð°Ñ ÑÑ‚Ð°Ð´Ð¸Ñ *" FontWeight="Bold" Foreground="DarkOrange"/>
										<ComboBox ItemsSource="{Binding AvailableStages}"
												  SelectedItem="{Binding SelectedStage}" HorizontalAlignment="Stretch">
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding Name}"/>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
								</Grid>
							</Border>

							<Grid ColumnDefinitions="*, 40, *">
								<StackPanel Grid.Column="0" Spacing="15">
									<TextBlock Text="Ð ÐµÐºÐ²Ð¸Ð·Ð¸Ñ‚Ñ‹ ÐÐ°ÑˆÐµÐ¹ Ð¤Ð¸Ñ€Ð¼Ñ‹" FontSize="16" FontWeight="SemiBold"/>
									<StackPanel Spacing="5">
										<TextBlock Text="ÐŸÐ¾Ð´Ð¿Ð¸ÑÐ°Ð½Ñ‚ ÑÐ¾ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¸ÑÑ‚Ð¸Ñ *"/>
										<ComboBox ItemsSource="{Binding Workers}" SelectedItem="{Binding SelectedFirmSigner}" HorizontalAlignment="Stretch">
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding LastName}"/>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
								</StackPanel>

								<StackPanel Grid.Column="2" Spacing="15">
									<TextBlock Text="Ð ÐµÐºÐ²Ð¸Ð·Ð¸Ñ‚Ñ‹ ÐšÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð°" FontSize="16" FontWeight="SemiBold"/>
									<StackPanel Spacing="5">
										<TextBlock Text="Ð—Ð°ÐºÐ°Ð·Ñ‡Ð¸Ðº/ÐšÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚ *"/>
										<ComboBox ItemsSource="{Binding Counterparties}" SelectedItem="{Binding SelectedCounterparty}" HorizontalAlignment="Stretch">
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding ShortName}"/>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
									<StackPanel Spacing="5">
										<TextBlock Text="ÐŸÐ¾Ð´Ð¿Ð¸ÑÐ°Ð½Ñ‚ ÑÐ¾ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹ ÐºÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð° *"/>
										<ComboBox ItemsSource="{Binding CounterpartyContacts}" SelectedItem="{Binding SelectedCounterpartySigner}" HorizontalAlignment="Stretch">
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding LastName}"/>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
								</StackPanel>
							</Grid>

							<Separator Background="LightGray"/>

							<StackPanel Spacing="15">
								<TextBlock Text="Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°" FontSize="16" FontWeight="SemiBold"/>

								<Grid ColumnDefinitions="*, 20, *, 20, *">
									<StackPanel Grid.Column="0" Spacing="5">
										<TextBlock Text="ÐÐ¾Ð¼ÐµÑ€ *" />
										<TextBox Text="{Binding ContractNumber}" />
									</StackPanel>
									<StackPanel Grid.Column="2" Spacing="5">
										<TextBlock Text="Ð’Ð°Ð»ÑŽÑ‚Ð° *" />
										<ComboBox ItemsSource="{Binding Currencies}" SelectedItem="{Binding SelectedCurrency}" HorizontalAlignment="Stretch">
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding Code}"/>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
									<StackPanel Grid.Column="4" Spacing="5">
										<TextBlock Text="Ð¡ÑƒÐ¼Ð¼Ð°" />
										<TextBox Text="{Binding ContractPrice}" IsReadOnly="{Binding !IsCustomerRole}" />
									</StackPanel>
								</Grid>

								<Grid ColumnDefinitions="*, 20, *, 20, *" IsVisible="{Binding IsConclusionStage}">
									<StackPanel Grid.Column="0" Spacing="5">
										<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ" />
										<DatePicker SelectedDate="{Binding IssueDate}" HorizontalAlignment="Stretch" />
									</StackPanel>
									<StackPanel Grid.Column="2" Spacing="5">
										<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°" />
										<DatePicker SelectedDate="{Binding StartDate}" HorizontalAlignment="Stretch" />
									</StackPanel>
									<StackPanel Grid.Column="4" Spacing="5">
										<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ" />
										<DatePicker SelectedDate="{Binding EndDate}" HorizontalAlignment="Stretch" />
									</StackPanel>
								</Grid>

								<StackPanel Spacing="5">
									<TextBlock Text="ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚" />
									<TextBox Text="{Binding ContractSubject}" AcceptsReturn="True" Height="60" TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>

							<Border Background="#FFF3E0" Padding="15" CornerRadius="8" IsVisible="{Binding IsTenderStage}">
								<StackPanel Spacing="15">
									<TextBlock Text="Ð¢Ð¾Ñ€Ð³Ð¸" FontWeight="Bold" Foreground="#E65100"/>
									<StackPanel Spacing="5" Width="300" HorizontalAlignment="Left">
										<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ñ‚Ð¾Ñ€Ð³Ð¾Ð² *" />
										<DatePicker SelectedDate="{Binding TenderDate}" HorizontalAlignment="Stretch"/>
									</StackPanel>
								</StackPanel>
							</Border>

							<Border Background="#E3F2FD" Padding="15" CornerRadius="8" IsVisible="{Binding IsSubmission}">
								<StackPanel Spacing="15">
									<TextBlock Text="Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð´Ð°Ñ‡Ð¸ Ð·Ð°ÑÐ²Ð¾Ðº" FontWeight="Bold" Foreground="#1565C0"/>
									<Grid ColumnDefinitions="*, 20, *">
										<StackPanel Grid.Column="0" Spacing="5">
											<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ *" />
											<DatePicker SelectedDate="{Binding SubmissionDate}" HorizontalAlignment="Stretch" />
										</StackPanel>
										<StackPanel Grid.Column="2" Spacing="5">
											<TextBlock Text="Ð˜Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ð·Ð°ÐºÑƒÐ¿ÐºÐ¸ *" />
											<TextBox Text="{Binding SubmissionCode}" />
										</StackPanel>
									</Grid>
									<StackPanel Spacing="5">
										<TextBlock Text="ÐÐ´Ñ€ÐµÑ ÑÐ»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð½Ð¾Ð¹ Ð¿Ð»Ð¾Ñ‰Ð°Ð´ÐºÐ¸" />
										<TextBox Text="{Binding SubmissionLink}" />
									</StackPanel>
								</StackPanel>
							</Border>

							<Border Background="#FFEBEE" Padding="15" CornerRadius="8" IsVisible="{Binding IsTermination}">
								<StackPanel Spacing="15">
									<TextBlock Text="Ð Ð°ÑÑ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°" FontWeight="Bold" Foreground="#C62828"/>
									<Grid ColumnDefinitions="*, 20, *">
										<StackPanel Grid.Column="0" Spacing="5">
											<TextBlock Text="Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ñ‚Ð¾Ñ€ *" />
											<ComboBox ItemsSource="{Binding Initiators}" SelectedItem="{Binding SelectedInitiator}" HorizontalAlignment="Stretch"/>
										</StackPanel>
										<StackPanel Grid.Column="2" Spacing="5">
											<TextBlock Text="Ð”Ð°Ñ‚Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ/Ñ€Ð°ÑÑ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ñ" />
											<DatePicker SelectedDate="{Binding ExecutionDate}" HorizontalAlignment="Stretch"/>
										</StackPanel>
									</Grid>
									<StackPanel Spacing="5">
										<TextBlock Text="ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð° Ñ€Ð°ÑÑ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ñ *" />
										<TextBox Text="{Binding TerminationReason}" AcceptsReturn="True" Height="60" TextWrapping="Wrap"/>
									</StackPanel>
								</StackPanel>
							</Border>

						</StackPanel>
					</ScrollViewer>
				</TabItem>

				<TabItem Header="Ð¡Ð¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ">
					<Grid RowDefinitions="Auto, *, Auto" Margin="10">
						<Button Grid.Row="0" Command="{Binding OpenSelectorCommand}"
								Classes="accent" Margin="0,0,0,10" Padding="15,8" HorizontalAlignment="Left">
							<StackPanel Orientation="Horizontal" Spacing="8">
								<TextBlock Text="+" FontWeight="Bold"/>
								<TextBlock Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ"/>
							</StackPanel>
						</Button>

						<DataGrid Grid.Row="1" ItemsSource="{Binding Specifications}" AutoGenerateColumns="False" IsReadOnly="True" GridLinesVisibility="All">
							<DataGrid.Columns>
								<DataGridTextColumn Header="ÐÐ¾Ð¼ÐµÐ½ÐºÐ»Ð°Ñ‚ÑƒÑ€Ð°" Binding="{Binding NomenclatureName}" Width="*"/>
								<DataGridTextColumn Header="ÐšÐ¾Ð»-Ð²Ð¾" Binding="{Binding Quantity}" Width="80"/>
								<DataGridTextColumn Header="Ð•Ð´. Ð¸Ð·Ð¼." Binding="{Binding UnitOfMeasure}" Width="80"/>
								<DataGridTextColumn Header="Ð¦ÐµÐ½Ð°" Binding="{Binding UnitPrice, StringFormat='{}{0:N2}'}" Width="120"/>
								<DataGridTextColumn Header="Ð˜Ñ‚Ð¾Ð³Ð¾" Binding="{Binding TotalAmount, StringFormat='{}{0:N2}'}" Width="120"/>
								<DataGridTextColumn Header="ÐÐ”Ð¡ (%)" Binding="{Binding VATRate}" Width="80"/>
								<DataGridTextColumn Header="Ð’ÑÐµÐ³Ð¾ Ñ ÐÐ”Ð¡" Binding="{Binding TotalVATAmount, StringFormat='{}{0:N2}'}" Width="140"/>
								<DataGridTemplateColumn Header="Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ" Width="80">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate DataType="dto:ContractSpecificationDto">
											<Button Command="{ReflectionBinding #Root.DataContext.DeleteSpecificationCommand}"
													CommandParameter="{Binding}" Foreground="Red" Content="âŒ" Background="Transparent" HorizontalAlignment="Center"/>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>
							</DataGrid.Columns>
						</DataGrid>

						<StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0" Spacing="10">
							<TextBlock Text="ÐžÐ±Ñ‰Ð°Ñ ÑÑƒÐ¼Ð¼Ð°:" FontWeight="Bold" VerticalAlignment="Center"/>
							<TextBlock Text="{Binding ContractPrice, StringFormat='{}{0:N2} Ñ€ÑƒÐ±.'}" FontWeight="Bold" FontSize="16" Foreground="#2E7D32"/>
						</StackPanel>
					</Grid>
				</TabItem>

				<TabItem Header="Ð­Ñ‚Ð°Ð¿Ñ‹ Ð¸ Ð“Ñ€Ð°Ñ„Ð¸Ðº">
					<Grid RowDefinitions="Auto, *">
						<Button Grid.Row="0" Command="{Binding OpenNewStepCommand}"
								Classes="accent" Margin="0,0,0,10" Padding="15,8" HorizontalAlignment="Left">
							<StackPanel Orientation="Horizontal" Spacing="8">
								<TextBlock Text="+" FontWeight="Bold"/>
								<TextBlock Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ð¿"/>
							</StackPanel>
						</Button>

						<DataGrid Grid.Row="1" ItemsSource="{Binding Steps}" AutoGenerateColumns="False" IsReadOnly="True" GridLinesVisibility="All">
							<DataGrid.Columns>
								<DataGridTextColumn Header="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð¿Ð°" Binding="{Binding StepName}" Width="*"/>
								<DataGridTextColumn Header="ÐÐ°Ñ‡Ð°Ð»Ð¾" Binding="{Binding StartStepDate}" Width="120"/>
								<DataGridTextColumn Header="ÐžÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ðµ" Binding="{Binding EndStepDate}" Width="120"/>
								<DataGridTextColumn Header="Ð¡ÑƒÐ¼Ð¼Ð° ÑÑ‚Ð°Ð¿Ð°" Binding="{Binding TotalAmount, StringFormat='{}{0:N2}'}" Width="150" FontWeight="Bold"/>
								<DataGridTemplateColumn Header="Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ" Width="100">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate DataType="dto:ContractStepDto">
											<StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
												<Button Command="{ReflectionBinding #Root.DataContext.EditStepCommand}"
														CommandParameter="{Binding}" Foreground="Orange" Content="âœï¸" Background="Transparent" Padding="5"/>
												<Button Command="{ReflectionBinding #Root.DataContext.DeleteStepCommand}"
														CommandParameter="{Binding}" Foreground="Red" Content="âŒ" Background="Transparent" Padding="5"/>
											</StackPanel>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>
							</DataGrid.Columns>
						</DataGrid>
					</Grid>
				</TabItem>
			</TabControl>
		</Grid>

		<Border Background="Black"
				Opacity="0.4"
				IsVisible="{Binding IsProductSelectorOpen}"
				ZIndex="100"/>

		<Border Width="450"
				HorizontalAlignment="Right"
				Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
				BoxShadow="-5 0 15 0 #40000000"
				IsVisible="{Binding IsProductSelectorOpen}"
				ZIndex="101">

			<Grid RowDefinitions="Auto, *, Auto" Margin="20">

				<Grid Grid.Row="0" ColumnDefinitions="*, Auto" Margin="0,0,0,20">
					<TextBlock Text="Ð’Ñ‹Ð±Ð¾Ñ€ Ð½Ð¾Ð¼ÐµÐ½ÐºÐ»Ð°Ñ‚ÑƒÑ€Ñ‹" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
					<Button Grid.Column="1" Command="{Binding CloseSelectorCommand}" Content="âœ•" Background="Transparent" FontSize="16"/>
				</Grid>

				<Grid Grid.Row="1" RowDefinitions="Auto, *">
					<TextBox Grid.Row="0" Text="{Binding ProductSearchText}" Watermark="ÐŸÐ¾Ð¸ÑÐº..." Classes="clearButton" Margin="0,0,0,15"/>

					<ListBox Grid.Row="1"
							 ItemsSource="{Binding FilteredProducts}"
							 SelectedItem="{Binding SelectedProductToAdd}"
							 Background="Transparent"
							 BorderThickness="1"
							 BorderBrush="LightGray"
							 CornerRadius="4">
						<ListBox.ItemTemplate>
							<DataTemplate DataType="dto:GoodsAndServiceDto">
								<StackPanel Margin="5">
									<TextBlock Text="{Binding Name}" FontWeight="SemiBold" TextWrapping="Wrap"/>
									<StackPanel Orientation="Horizontal" Spacing="10">
										<TextBlock Text="{Binding Price, StringFormat='Ð¦ÐµÐ½Ð°: {0:N2} Ñ€ÑƒÐ±.'}" Foreground="Gray" FontSize="12"/>
										<TextBlock Text="{Binding UnitOfMeasure}" Foreground="Gray" FontSize="12"/>
									</StackPanel>
								</StackPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</Grid>

				<StackPanel Grid.Row="2" Spacing="15" Margin="0,20,0,0">
					<Grid ColumnDefinitions="*, 20, *">
						<StackPanel Grid.Column="0" Spacing="5">
							<TextBlock Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾" FontWeight="SemiBold"/>
							<TextBox Text="{Binding QuantityToAdd}"/>
						</StackPanel>

						<StackPanel Grid.Column="2" Spacing="5">
							<TextBlock Text="Ð¡Ñ‚Ð°Ð²ÐºÐ° ÐÐ”Ð¡ (%)" FontWeight="SemiBold"/>
							<TextBox Text="{Binding VatRateToAdd}"/>
						</StackPanel>
					</Grid>

					<Button Command="{Binding AddSpecificationCommand}"
							Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚"
							Classes="accent"
							HorizontalAlignment="Stretch"
							HorizontalContentAlignment="Center"
							Padding="10,12"
							FontWeight="Bold"/>
				</StackPanel>

			</Grid>
		</Border>

		<Border Background="Black" Opacity="0.4" IsVisible="{Binding IsStepEditorOpen}" ZIndex="102"/>

		<Border Width="600"
				HorizontalAlignment="Right"
				Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
				BoxShadow="-5 0 15 0 #40000000"
				IsVisible="{Binding IsStepEditorOpen}"
				ZIndex="103">

			<Grid RowDefinitions="Auto, Auto, *, Auto" Margin="20">

				<Grid Grid.Row="0" ColumnDefinitions="*, Auto" Margin="0,0,0,20">
					<TextBlock Text="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑÑ‚Ð°Ð¿Ð°" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
					<Button Grid.Column="1" Command="{Binding CloseStepCommand}" Content="âœ•" Background="Transparent" FontSize="16"/>
				</Grid>

				<StackPanel Grid.Row="1" Spacing="15" Margin="0,0,0,20">
					<StackPanel Spacing="5">
						<TextBlock Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð¿Ð° *" FontWeight="SemiBold"/>
						<TextBox Text="{Binding CurrentEditingStep.StepName}" Watermark="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÐŸÑ€ÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð° / ÐžÑ‚Ð³Ñ€ÑƒÐ·ÐºÐ° 1 Ð¿Ð°Ñ€Ñ‚Ð¸Ð¸"/>
					</StackPanel>

					<Grid ColumnDefinitions="*, 20, *">
						<StackPanel Grid.Column="0" Spacing="5">
							<TextBlock Text="ÐÐ°Ñ‡Ð°Ð»Ð¾ ÑÑ‚Ð°Ð¿Ð°" FontWeight="SemiBold"/>
							<DatePicker SelectedDate="{Binding CurrentEditingStep.StartStepDate}" HorizontalAlignment="Stretch"/>
						</StackPanel>
						<StackPanel Grid.Column="2" Spacing="5">
							<TextBlock Text="ÐžÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð¿Ð°" FontWeight="SemiBold"/>
							<DatePicker SelectedDate="{Binding CurrentEditingStep.EndStepDate}" HorizontalAlignment="Stretch"/>
						</StackPanel>
					</Grid>
				</StackPanel>

				<DockPanel Grid.Row="2">
					<TextBlock DockPanel.Dock="Top" Text="Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð¼ÐµÐ½ÐºÐ»Ð°Ñ‚ÑƒÑ€Ñ‹" FontWeight="Bold" Margin="0,0,0,10"/>

					<DataGrid ItemsSource="{Binding StepEditorItems}" AutoGenerateColumns="False" GridLinesVisibility="Horizontal">
						<DataGrid.Columns>
							<DataGridTextColumn Header="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="*" IsReadOnly="True"/>
							<DataGridTextColumn Header="Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾" Binding="{Binding AvailableQuantity}" Width="80" IsReadOnly="True" Foreground="Gray"/>

							<DataGridTemplateColumn Header="Ð’ ÑÑ‚Ð°Ð¿ (ÑˆÑ‚)" Width="100">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate DataType="vm:StepItemWrapper">
										<TextBox Text="{Binding QuantityToTake}" TextAlignment="Center" Margin="2"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>

							<DataGridTextColumn Header="Ð¡ÑƒÐ¼Ð¼Ð°" Binding="{Binding StepTotalAmount, StringFormat='{}{0:N2}'}" Width="100" IsReadOnly="True"/>
						</DataGrid.Columns>
					</DataGrid>
				</DockPanel>

				<StackPanel Grid.Row="3" Spacing="15" Margin="0,20,0,0">
					<Grid ColumnDefinitions="*, Auto">
						<TextBlock Grid.Column="0" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ ÑÑ‚Ð°Ð¿Ñƒ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="16"/>
						<TextBlock Grid.Column="1" Text="{Binding CurrentStepTotalAmount, StringFormat='{}{0:N2} Ñ€ÑƒÐ±.'}"
								   VerticalAlignment="Center" FontWeight="Bold" FontSize="18" Foreground="#1976D2"/>
					</Grid>

					<Button Command="{Binding SaveStepCommand}"
							Content="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ð¿"
							Classes="accent"
							HorizontalAlignment="Stretch"
							HorizontalContentAlignment="Center"
							Padding="10,12"
							FontWeight="Bold"/>
				</StackPanel>

			</Grid>
		</Border>
	</Grid>
</UserControl>